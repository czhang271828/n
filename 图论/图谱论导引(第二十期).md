# 图谱论导引(第二十期)

>  本章介绍两个好玩的定理: 非对称图密度定理与Kuratowski定理. 两定理叙述如下:
>
> * 对称图密度定理: 几乎所有的简单图是非对称的.
> * 简单图为平面图, 若且仅若其任一子图均不与$K_5$或$K_{3,3}$同胚. 

### 非对称图密度定理

非对称图指一类自同构仅为恒等映射的图. 本小节将通过Burnside引理证明以下结论: 几乎所有的简单图都是非对称的. 换言之, 记$p(n)$为顶点数小于$n$的所有简单图中非对称图的比例, 则$\lim_{n\to\infty} p(n)=1$. 

对选定$n$, 记顶点集为$V=\{v_1,v_2,\ldots,v_n\}$. 随机连接$V$内点即可得$2^{\binom{n}{2}}$种简单图, 记之为整体$\mathcal G$. 诚然其中有同构者, 例如所有同构于$X$的图共计$\dfrac{n!}{|\mathrm{Aut}(X)|}$个. 因而所有不重子图之总数(即轨道总数)为
$$
\sum_{G\subset\mathcal G}\dfrac{1}{|\mathrm{Aut}(G)|}.
$$
根据Burnside引理, 即
$$
\dfrac{1}{n!}\sum_{g\in\mathrm{Sym}(V)}|\{G\in\mathcal G:g(G)=G\}|=\dfrac{1}{n!}\sum_{g\in\mathrm{Sym}(V)}2^{\mathrm{orb}(g)}.
$$
其中记$\mathrm{orb}(g)$为$g$在$E$中的轨道数量, 即用$g$不断作用于$E$中各边所得的不重的单循环的数量. 

举例而言, 不妨设置换$g$有$2r$个动点, $r$为正整数. 则$\mathrm{orb}(g)$取最大值时, 每组循环节应尽可能地短: 此时$g$为$r$组不交对换. 此时非不动边$(x,y)$分作两类: $x,y$均为动点且$g(x)\neq y$, $x$为动点而$y$为不动点. 前一情形包括$2r(r-1)$条边, 后一情形包括$2r(n-2r)$条边. 从而长为$2$的轨道数量为$2r(r-1)+2r(n-2r)$, $g$在$E$下轨道数量为
$$
\mathrm{orb}(g)=\binom{n}{2}-r(n-r-1).
$$
若所有图均为非对称图, 则等价类数量为$\dfrac{2^{\binom{n}{2}}}{n!}$. 下证明实际的等价类数量为$(1+o(1))\dfrac{2^{\binom{n}{2}}}{n!}$. 

任意选定$m\leq n-2$为正偶数, 划分$\mathrm{Sym}(V)$为三类: 恒等映射集合$C_1$, 非不动点数至多为$m$的映射之集合$C_2$, 及其余者之集合$C_3$. 从而
$$
|C_2|\leq\binom{n}{m}m!,\quad|C_3|\leq n!.
$$
据先前证明, $C_2$中每一映射至多有$\displaystyle{\binom{n}{2}-(n-2)}$条轨道, $C_3$中每一映射至多有$\displaystyle{\binom{n}{2}-\dfrac{m}{2}(n-m/2-1)\leq\binom{n}{2}-\dfrac{mn}{4}}$. 从而
$$
\begin{align*}
&\sum_{g\in \mathrm{Sym}(V)}2^{\mathrm{orb}(g)}\\
\leq& 2^{\binom{n}{2}}+\binom{n}{m}m!\cdot2^{\binom{n}{2}-(n-2)}+n!\cdot2^{\binom{n}{2}-mn/4}\\
\leq& 2^{\binom{n}{2}}\left(1+\dfrac{n\cdots(n-m+1)}{2^{n-2}}+\dfrac{n!}{2^{mn/4}}\right)
\end{align*}
$$
由于$\dfrac{n!}{2^{mn/4}}$在$m> \lfloor 4\log n\rfloor+\varepsilon_0$时递减至$0$, $\dfrac{n\cdots(n-m+1)}{2^{n-2}}$在$m\sim \log n$时一定单减至$0$, 从而取$m\geq\lfloor 5\log n\rfloor$即可得
$$
\sum_{g\in \mathrm{Sym}(V)}2^{\mathrm{orb}(g)}=2^{\binom{n}{2}}(1+o(1)).
$$

### Kuratowski定理

Kuratowski定理给出了判定简单图为平面图与否的充要条件: 图为平面图若且仅若其任一真子图均不同胚于$K_5$与$K_{3,3}$中任一者. 例如Petersen图非平面图, 以下任一张图即为证明:

![](https://files.mdnice.com/user/12571/716139b8-6d68-47fb-b9ca-cfcd2fcce054.png)

![](https://files.mdnice.com/user/12571/646d30dc-848a-4512-b8c4-79545406cfda.png)

证明Kuratowski定理之充分性相对较易, 仅需说明$K_5$与$K_{3,3}$均非平面图即可. 记图边数为$e$, 顶点数为$v$, 面数为$f$(视无穷大的外部为一个面), 根据Euler定理有
$$
f+v-e=2.
$$
注意到每个面至少包含了$3$条边, 从而$2e\geq 3f=3(e+2-v)$, 故$e\leq 3v-6$. 由是可见$K_5$非平面图. 同样, 对不含$C_3$子图(即三角形)的简单图而言, $e\leq 2v-4$. 从而$K_{3,3}$非平面图. 基于上述公式, 以下两则结论成立:

1. 若简单图为平面图, 则图的最小度不超过$5$.
2. 若简单图为平面图且不含$C_3$子图, 则图的最小度不超过$3$.

注意到, $K_{3,3}$距平面图仅一步之遥: $K_{3,3}$的任意真子图均为平面图. 下称此类图为极小非平面图. 显然, 所有极小非平面图为$2$-连通的(即任意删点图均连通); 反之不妨假设$G$为$1$-连通的极小非平面图, 则存在$v\in V(G)$使得$G-v$为若干个不连通的平面图, 与$G$非平面图之事实矛盾. 

继而证明Kuratowski定理之必要性. 不妨设$G$为所有不含同胚与$K_{3,3}$或$K_5$子图的边数最少的非平面简单图, 下先证明$G$为$3-$连通的. 

若不然, 不妨假设设$G$为$2$-连通的, 即存在两点$\{u,v\}$使得$G-\{u,v\}$为$C_1$与$C_2$之无交并. 由于$G$为极小非平面图, 则$G-V(C_1)$与$G-V(C_2)$均为平面图. 下讨论如下几类情况:

1. 如下图所示, 若$u\sim v$且$G-V(C_1)-V(C_2)$包含边$uv$. 此时$G$显然为平面图, 因为$C_1$与$C_2$可表示在某个经过边$uv$的平面上. 与$G$非平面图矛盾.

   ![](https://files.mdnice.com/user/12571/f6a6681b-7df7-40ba-8a9d-b59c95dcf72d.png)

2. 如下图所示, 若$u\sim v$而$G-V(C_1)-V(C_2)$不包含边$uv$. 此时$G$显然为平面图, 因为$C_1$与$C_2$可表示在某个经过边$uv$的平面上. 与$G$非平面图矛盾.

   ![](https://files.mdnice.com/user/12571/37c4883b-0283-4e4f-93a2-f19fdea0cfce.png)

3. 如下图所示, 若$u\not\sim v$, 则存在一条$G-C_1$中的路且其端点为$\{u,v\}$. 记命题$A_1$为存在不包含$C_1$中所有顶点的路$u-a-\cdots-b-v$; 对称地, 记命题$A_2$为存在不包含$C_2$中所有顶点的路$u-a'-\cdots-b'-v$. 当$A_1$与$A_2$中一者成立时(不妨设$A_2$成立), 在$G-C_2+uv$仍为平面图, 因为真子图
   $$
   G-C_2+(u-a-\cdots-b-v)
   $$
   为平面图. 此时可归结为上两类情形, 故与假设矛盾. 若$A_1$与$A_2$均不成立, 则$G$为圈, 矛盾.

   ![](https://files.mdnice.com/user/12571/14dfe8d5-9b2b-409d-be99-e412ef264ea7.png)

为导出$G$不存在之矛盾, 不妨设$u$与$v$相邻, 下就$u$与$v$之公共邻域数量以讨论. 

1. 若$|N(u)\cap N(v)|\geq 3$, 则$G$为下图(同胚于$K_5$).

   ![](https://files.mdnice.com/user/12571/76298a23-9677-4d9a-b414-5e7b2ced057e.png)

2. 若$|N(u)\cap N(v)|\leq 2$, 显然$N(v),N(v)$均大于等于$3$, 反之$G$为平面图. 当$N(u)$与$N(v)$中六点相嵌时, 则以下子图包含$K_{3,3}$.

   ![](https://files.mdnice.com/user/12571/d029ba32-115e-4839-a7da-7ba10fd7cf75.png)

   反之, $G$为

   ![](https://files.mdnice.com/user/12571/4d6b28ca-d252-4e86-98ca-fd1b8d9d6d22.png)

   系平面图. 

综上, 不存在不含同胚与$K_{3,3}$或$K_5$子图的边数最少的非平面简单图, 从而Kuratowski定理成立. 


