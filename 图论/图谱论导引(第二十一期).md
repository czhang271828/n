# 图谱论导引(二十一期)

> 本节将介绍染色多项式.

今有如下问题: 若使用$k$种颜色对简单图$G$染色, 且确保任一边的顶点异色, 试问可选的染色方案总数? 例如$P_n$的$k$色染色方式为$k(k-1)^{n-1}$, $K_n$的$n+k$色染色方式为$\binom{n+k}{n}$. 若问及Petersen图的$6$色染色方法数, 求解相对困难. 读者自然会想到递推法求解: 对任一简单图$G$, 记$k$染色方法总数为函数$P(G,x)$, 试问如何求解$P(G,x)$?

经尝试, $P(G,x)$为某一多项式函数(此处暂时略去$P(G,x)= 0$之情形). George David Birkhoff于1912年首次提出该多项式, 其目的系解决四色猜想, 即证明对任一平面图$G$均有$P(G,4)>0$. 显然G. D. Birkhooff未能因此解决四色猜想, 但染色多项式之引入确实为组合与图论学科添上浓墨重彩的一笔. 

### 染色多项式之多项式说

首先应当证明$P(G,x)$为多项式. 约定$\forall e\in E(G)$, $G-e$即$G$删去边$e$所得, $G/e$即$G-e$中粘合$e$两端的点所得. 

![](https://files.mdnice.com/user/12571/c9e7f25e-18f0-4290-9908-ab32141ecd00.png)

此处, 虽约定$G$为简单图, 但点染色确实与重边无关. 由于图$G/e$未免引入重边, 读者自行约化之为简单图. 

不妨设$E(G)\geq 1$​. 对任意$x_0\in\mathbb N^+$​, $G-e$​中$u$​与$v$​同色之染色数为$P(G/e,x_0)$​, $u$​与$v$​异色之染色数为$P(G,x_0)$​. 因此得递推式
$$
P(G-e,x)=P(G,x)+P(G/e,x).
$$
从而对任意简单图而言, $P(G,x)$为多项式. 读者可自行证明Petersen图的染色多项式为
$$
x(x-1)(x-2)\left(x^{7}-12x^{6}+67x^{5}-230x^{4}+529x^{3}-814x^{2}+775x-352\right)
$$
此外, 递推$P(G,x)=P(G-e,x)-P(G/e,x)$表明$\deg P(G,x)\leq \deg P(G-E,x)=|V(G)|$; 另一方面, 诸$G$删边/删点所得的多项式中, 仅$P(G-E,x)$之度数为极大值$|V(G)|$. 综上, $\deg P(G,x)=|V(G)|$. 归纳如下图所示

![](https://files.mdnice.com/user/12571/1d2c19bf-7e34-4fe6-8bc3-1586774bdad2.png)

### 构造关系

对有限个不交的简单图$G_0:=\{G_i\}_{i=1}^m$, 有
$$
P(G_0,x)=\prod_{i=1}^mP(G_i,x).
$$
由群作用关系可知, 若$V(G)\cap V(H)=\{v\}$​, 则$P(G\cup H,x)=\dfrac{P(G,x)\cdot P(H,x)}{x}$​. 同理, 若$P(G\cap H)$为完全图, 则
$$
P(G\cup H,x)=\dfrac{P(G,x)P(H,x)}{P(G\cap H,x)}.
$$

### 系数性质

##### 最高项系数

对多项式$P(G,x)$, 记$n=|V(G)|$, 则注意到$x$足够大时有关系
$$
x^n\geq P(\overline {K_n},x)\geq P(G,x)\geq P(K_n,x)\geq\binom{x}{n}.
$$
故$P(G,x)$最高项系数为$1$. 

##### 次高项系数

使用上述归纳法计算$P(G,x)$时, 注意到所有次高项来自归纳时所有顶点数为$|V(G)|-1$之图. 如此之图出现$|E|$次, 从而次高项系数为$-|E|$. 

##### 系数交替性

由递推式$P(G-e,x)=P(G,x)+P(G/e,x)$可知$P(G,x)$系数交替. 注意到
$$
P(G,x)=\sum_{i=0}^{|V(G)|}a_ix^i-\sum_{i=0}^{|V(G)|-1}b_ix^i=x^{|V(G)|}+\sum_{i=0}^{|V(G)|-1}(a_i-b_i)x^i.
$$
数学归纳法知$P(G,x)$第$k$项系数符号为$(-1)^{k+1}$, 从而染色多项式系数交替. 

此处另需说明一点: 若$P(G,x)$的$k$次项系数为$0$, 则对任意$i\leq k$, $i$次项系数为$0$. 同样可采用数学归纳法证明之, 此处省略. 

##### 最低次非零系数

显然任意染色多项式之常数项为$0$. 下有一更具普适性的结论: 最低次非零项之次数为图的连通部件数. 欲证明之, 只需验证如是结论: $P'(G,0)\neq 0$若且仅若$G$连通. 

若$G$为非连通图, 则存在$G_1$, $G_2$使得$G=G_1\dot\cup G_2$. 进而多项式$P(G,x)=P(G_1,x)P(G_2,x)$有因子$x^2$, 从而$P'(G,0)=0$.

若$G$为连通图, 则不妨设上述结论对$|E(V)|\leq m$之情形成立, 下归纳证明对$|E(V)|=m+1$之情形成立. 仍考虑递推关系
$$
P(G,x)=x^{|V(G)|}+\sum_{i=0}^{|V(G)|-1}(a_i-b_i)x^i.
$$
显然$a_{|V(G)|}b_{V(G)}\leq 0$, 而对任意$e\in E(G)$, $P(G-e,x)$一次项不为$0$. 从而$P(G,x)$一次项$a_{|V(G)|}-b_{|V(G)|}\neq 0$. 

综上, $P'(G,0)=0$若且仅若$G$有多个连通分支. 从而$P(G,x)$的最低次非零项之次数为图的连通部件数. 

##### 单峰定理

考虑顶点数为$n$的树$T$, 易知$G(T,x)=x(x-1)^{n-1}$, 其系数大小$|a_k|=\binom{n-1}{k-1}$于$0\leq k\leq \dfrac{n-1}{2}$时递增, $\dfrac{n-1}{2}\leq k\leq n$时递减. 对任意顶点数为$n$的连通图$G$, 总可通过归纳式$P(G,x)=P(G-e,x)-P(G/e,x)$使得$P(G,x)$为若干树的染色多项式之叠加. 归纳时只需不断选取非割边, 迭代至出现树时停止即可. 

最终$P(G,x)$具有一般形式$P(G,x)=\sum_{i}(-1)^{p(i)}P(G_i,x)$, 其中$p(i):=\deg P(G_i,x)$. 据系数符号之交替律, 对选定的$j$, 任意$(-1)^{p(i)}P(G_i,x)$之$j$次项系数同号. 由于每一树染色多项式$P(G_i,x)$之系数极大项不超过$x^{[n/2]+1}$次, 故
$$
1=|a_n|<|a_{n-1}|< \cdots<|a_{\lfloor n/2\rfloor+1}|.
$$
据June Huh在[论文](https://web.math.princeton.edu/~huh/MilnorChromatic.pdf)中结论, 任意图的染色多项式时单峰的, 即存在$k$使得
$$
1=|a_{|V|}|\leq |a_{|V|-1}|\leq \cdots\leq |a_{k}|\geq|a_{k+1}|\geq\cdots\geq|a_1|.
$$

### 零点

##### 自然数零点的重数估计

据上文结论, 零点$x=0$之重数为图之连通部件数目. 下初步探究$1$之重数. 

对任意连通图, $P(G,1)=0$. 若图有唯一的割点$e$, 则不妨设$G=G_1\cap G_2$且$G_1\cap G_2=e$. 故$P(G,x)=\dfrac{P(G_1,x)P(G_2,x)}{x}$. 零点$1$之重数呼之欲出, 但此前应先明确区块之概念: 图的区块定义为极大$2$-连通子图. 例如下图之区块数为$13$. 

![](https://files.mdnice.com/user/12571/e3d3f79e-9ba4-4c84-bcfb-00a458f90eb1.png)

另上图为$G$, 记所有区块为$\{G_i\}_{i=1}^{13}$, 则
$$
P(G,x)=\dfrac{\prod_{i=1}^{13}P(G,x)}{x^{12}}
$$
且每一$P(G_i,x)$或为$2$-连通的, 或为$K_2$. 对任一$G_i$, 不存在一组分割$G_i^1,G_i^2$使得$G_i^1\cap G_i^2$为单点而$G^1_i\cup G_2^2=G_i$; 等价地, $P(G_i,x)$的零点中仅有一重$1$. 从而得结论: $P(G,x)$中$(x-1)$因子之次数为区块数. 

$|P(G,-1)|$的含义较神奇, 其描述了$G$中不含定向圈的定向方式. 换言之, 对$G$中边赋予朝向某一顶点的方向且保证图中不含定向的圈, 其可选方法之总数为$|P(G,-1)|$. 实际上, 注意到$|P(G,-1)|=(-1)^nP(G,-1)$, 以及
$$
|P(G,-1)|=|P(G-e,-1)|+|P(G/e,-1)|
$$
即可证之. 

##### 应用: 梯子上的定向问题

给定的梯子, 视每处连接点为顶点, 相邻顶点间的连边(若有)视作边(如下图所示). 现给每条边随机赋予方向, 试问梯子上含有定向环的概率?

<img src="https://files.mdnice.com/user/12571/282b6c54-05e7-4381-b5f2-9b9a7c90c701.png" style="zoom:10%;" />

不妨设梯子高度为$n$, 即含有$2(n+1)$个顶点. 设$f_n(x)$为高为$n$的梯子的染色多项式, 则据递推关系有
$$
f_n(x)=\dfrac{f_1(x)f_{n-1}(x)}{P(K_2,x)}=\dfrac{f_1(x)^{n}}{P(K_2,x)^{n-1}}.
$$
计算得$f_1(x)=x(x-1)(x^2-3x+3)$, 故
$$
f_n(x)=x(x-1)(x^2-3x+3)^n.
$$
从而高为$n$的梯子上随机定向所成的无定向圈图占比
$$
\dfrac{|f_n(-1)|}{2^{E_n}}=\dfrac{2\cdot 7^n}{2^{3n+1}}=\left(\dfrac78\right)^n
$$

##### 零点分布

实质上, $G$上的正确染色将$V(G)$分作若干部分, 每一部分中的点于$G$中两两不交. 遂考虑记$\sigma$为一种的$V(G)$划分, 使得每一子集中的点于$G$中两两不相邻. 记$|\sigma|$为划分的区域数量, 则
$$
P(G,x)=\sum_{\sigma}\binom{x}{|\sigma|}.
$$
因此$G$之零点至大不过$\max|\sigma|-1= n-1$. 

据系数符号交替性, $x<0$时总有$\{a_ix^i\}_{i=1}^n$同号, 因此$P(G,x)$于$\mathbb R_-$中无零点. 

更深入地, Jackson证明了对任意$G$, $P(G,x)$于
$$
(-\infty,32/27]-\{0,1\}
$$
上无零点. Thomassen进而证明了所有$P(G,x)$的实零点之集合于$(32/27,+\infty)$上稠密. 同时, 并非所有的"简单"代数数都为可取之零点, 例如Read与Tutte证明了$\dfrac{\sqrt 5+1}{2}$恒非零点, 等价于任意$P(G,x)$不含因式$(x^2-x-1)$.

