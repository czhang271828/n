---
title: 麻雀儿中的向听数
date: 2021-09-15, 13:49:49
category: 
- 本科笔记
- 组合
tags: 
- 棋牌
- 图论
mathjax: true
---
# 麻雀儿中的向听数


### 麻雀儿之和牌方式

东亚文化圈内, 麻雀儿的玩法大同小异. 当下全球范围内影响力最大的应当是立直(リーチ)麻雀儿, 而笔者更偏爱国标(番种有趣, 如$x$色$y$节高, 推不倒, 全不靠, 小于/大于五, 组合龙). 不论如何, 十三张麻雀儿的通用规则大体相合: 做牌的本质是做齐四组面子加一组雀头(不包括全不靠, 十三幺, 四暗杠与七小对等). 记三张相连的牌为一顺, 三张相同的牌为一刻, 两张相同的牌为一对(可作雀头), 则和牌的基本型为四组面子(刻或顺)加一组雀头, 例如下图为四顺+雀头之胡牌方式(国标至少计之一步四色高32番与混一色6番).

![](https://files.mdnice.com/user/12571/b4ae45c5-30ea-48fa-b6ab-9fe6a9ecac83.png)

下图为一顺+三刻+雀头之胡牌方式(国标至少计之清一色24番, 一色三节高24番, 与小于五12番, 四归一4番, 双暗刻2番).

![](https://files.mdnice.com/user/12571/9a27d4d1-4705-46a9-8431-d0f82694893e.png)

一副现代麻雀儿牌如下:

![](https://files.mdnice.com/user/12571/85d39a24-7cc9-40ba-a374-362558d4efa6.png)

通用名称如下(四君子之顺序一般作梅兰菊竹):

![](https://files.mdnice.com/user/12571/8fe20d2e-cd46-4b45-a5cb-76bb21ec7fba.png)

下采用$B$(Bamboo)表示条子(部分地区称索), $C$(Characters)表示万子(部分地区称字), $D$(Dots)表示饼子(部分地区称洞). 如$C3$表示三条. 

写至此处, 先总结一些名词

| 名称 | 例子(以饼为例) | 定义                   |
| ---- | -------------- | ---------------------- |
| 暗刻 | 111            | 三张未碰出的相同牌     |
| 明刻 | 111            | 三张已碰出的相同牌     |
| 暗顺 | 123            | 一副未吃出的顺子       |
| 明顺 | 123            | 一副已吃出的顺子       |
| 暗杠 | 1111           | 四张未杠出的相同牌     |
| 明杠 | 1111           | 四张已杠出的相同牌     |
| 双面 | 23             | 可吃两种牌的搭子       |
| 嵌张 | 13             | 可吃一种牌的非连续搭子 |
| 边张 | 12             | 可吃一种牌的连续搭子   |
| 雀脚 | 11             | 两张相同的牌, 和牌用   |

> 注1: 碰出的牌无法打出, 但可以在此基础上杠牌; 但无法对吃出的牌做任何操作. 碰牌或吃牌可看作商去三张牌, 做牌作用于原手牌之陪集上.
>
> 注2: 暗杠可自行杠出, 留之(一般而言)无特别之用途. 暗杠可分散用作顺子, 刻子或雀脚. 国标中, 保留暗杠的和牌通常加番, 每暗杠4番(番中系绝和张). 

### 向听数

定义$S$为一组牌(摸牌后情形, 即十四张), 记$S_1\sim S_2$为牌$S_1$与$S_2$相邻, 若且仅若$S_1$可通过换一张牌得到$S_2$. 视所有可能的牌组情形为点, 按上述相邻关系形成图$G$. 现将$G$中一切和牌之情形染色为红, 将不和牌之情形染色为蓝, 则蓝点至红点的最近距离称作点对应蓝牌的向听数. 教程ネット麻雀戦術書「ビギナーズラック」中有一重要结论: 任意牌的向听数不超过$6$(但显然系经验之谈, 未给出证明). 本文旨在给出一般和法的向听公式, 并证明一般牌型的向听数不超过$8$. 之所以国标与日麻之向听数不超过$6$, 是因为有七小对(立直称ニコニコ, 两个两个之意).

此外, 国标中十三幺十三张听(和牌, 立直称作国士無双十三面待ち)在标准和牌之意义下属于八向听, 实际算是大番种的和牌. 

![](https://files.mdnice.com/user/12571/033009f2-c39a-44c4-bc7e-d6f262dc1051.png)

> 注: 本文中的向听数按十四张牌计算. 

### 向听数计算公式

> 注: 本节中, 和牌按照$4\times3 +2$式的标准型计算. 

首先明确, 和牌的向听数为$-1$, 听牌的向听数为$0$. 对于向听数较低的起手牌(14张)而言, 面子, 对子, 搭子, 以及孤立牌的数量与向听数呈线性关系. 不妨设(不重复计数)$x$为向听数, $m$为面子与刻字之数量和, $y$为预备子(搭子与对子之数量和), $q$为雀头示性函数, 和牌形对应$(m,y,q)=(4,0,1)$, 例如$(122334B888C45699D)$为和牌. 

显然$(3,1,1)$对应听牌(打出一张后摸到特定的牌即判定为和), 例如$(23456B888C145699D)$为听牌, 打出$1D$后听$147B$(五联牌至多听三张). 应注意到, 相邻的两个双面搭子(四联牌)可等价与一面加一张孤立牌, 例如十三张手牌
$$
(568B123999C2345D).
$$
在摸到$8B$时可打出$2D$听$47B$; 在摸到$6D$时可打出几乎无用的$8B$(打$8B$仅损失摸到$8B$得雀头之情形, 若在选择打$9C$的情形下仍能保住$8B$, 几乎不可能. 因此$8B$应较$9C$先打). 如此可见$2\Delta m\sim \Delta y$, 从而向听数公式应大致为
$$
x=-2m-y+R.
$$
之形式, 其中$R$为某些修正项. 上述情形说明了两组预备子与一组面子的等价关系, 但在某些情况下不应视之等价: 注意到和牌时$m+y= 4$, 考虑单调将(听雀头牌)之情形, 应视$m+y\geq4$为溢出(也可作$m+y>4$, 稍后可知$m+y=4$为公式的临界点), 如牌
$$
(12356B2367C35888D).
$$
对有雀头的溢出情形, 我们希望打去孤立牌及至少一组预备子. 由于(前后均溢出情形下)每新凑出一组面子后向听数减一, 雀头自作一项, 从而溢出牌的向听数计算公式为
$$
x=4-m-q.
$$
例如牌
$$
(124578B124578C12D)
$$
需换五张方可和(和牌$-1$向听), 从而$4=x=4-0-0$成立. 

对未溢出之情形, 向听数
$$
x=8-2m-y-q
$$
是自明的. 例如手牌
$$
(11566B56C4566777D)
$$
中$(m,y,q)=(2,2,1)$或$(2,3,0)$, 向听数为$1$. 实际上换一张$6B$为$4B$, 换一张$6D$为$4C$即可和牌. 事实上, 笔者昨日是以两向听的方式和牌的: 在其余牌齐全之情形下, 牌组
$$
(4566777)
$$
听$3,5,6,8$四类牌(至多$13$张). 引用立直麻雀儿的结果(国标几乎无别):

| 向听数     | 类型数         | 组合数                | 概率                |
| ---------- | -------------- | --------------------- | ------------------- |
| 和牌($-1$) | $16873619$     | $12859078207674$      | $\dfrac{1}{330530}$ |
| 听牌($0$)  | $2133064968$   | $2966241795738948$    | $\dfrac{1}{1433}$   |
| $1$        | $35934777211$  | $99154452630748356$   | $2.3\%$             |
| $2$        | $130938507660$ | $828714358375292670$  | $19.5\%$            |
| $3$        | $121685916468$ | $1867404976243926528$ | $43.9\%$            |
| $4$        | $33290266817$  | $1211948980271480832$ | $28.5\%$            |
| $5$        | $2496505635$   | $233501763289743360$  | $5.5\%$             |
| $6$        | $24592122$     | $6601397483077632$    | $\dfrac{1}{644}$    |

> 数据参考: 
>
> http://www10.plala.or.jp/rascalhp/mjmath.htm#12.

天和(坐庄且上牌即和牌)之概率相当于连抛$18$次硬币且均为正面朝向. 国标中, 天和总番数翻至原来的$3$倍, 给分显然不够体面. 此外, $14$张牌向听数的期望约为$3.156$, 因此庄家的牌平均换$\pi$张左右即可和. 川麻中"换三张"后另需绝一门, 大概就是担心天和过频?

### 清一色的向听数

清一色即全14张牌同色, 包括饼子清一色, 条子清一色, 万子清一色. 另有字一色(只含字牌东南西北中发白), 绿一色(只含$23468$条与发财, 即牌全绿)等悉不予讨论. 下有一个不大显然的定理: 清一色之向听数不超过$3$, 取等情形如
$$
S=(11222344558899).
$$
读者可自行尝试. 

下将从搭子的分布思考, 下统一记搭子为$(ab)$形式, $b> a$. 根据鸽笼原理, 任意四张不同的牌一定能凑成一组搭子(包含两面, 边张, 嵌张), 因为两张不同的牌可构成搭子若且仅若其间隔不超过一张牌. 称两个搭子$(ab)$与$(cd)$相离若且仅若$c\geq b$或$a\geq d$. 同理可定义两顺子相离. 

由于对子与搭子仅需一张牌即可凑成三张(顺子或刻子), 下统称搭子与对子为预备子. 下将证明引理: 假设$S$由六张同色牌组成且不含杠, 则$S$包含两对相离的预备子. 

不妨设$S=(abcdef)$为非减排列. 

1. 若$S$含有三张相同的牌, 则去除两张重合牌后, 剩余的四张牌包含两个相离的预备子(因为$S$不含四张相同的牌).
2. 若$S$不含三张相同的牌, 但含有两张相同的牌. $S$含有大于一组对子时显然. $S$仅含有一组对子时, 余下的四张牌一定能凑出一组搭子. 若改组搭子与对子相离则显然; 反之, 不妨$S$中包含组合$(1223)$, 则$(12)$与$(23)$相离, 证毕.
3. 若$S$中牌互不相同, 据鸽笼原理显然.

下证明主定理, $S$为清一色牌:

1. 若$S$有且仅有四组不交面子, 则剩下的两张牌在一次换牌后即可成为雀脚, 向听数为$0$.

2. 若$S$有且仅有有三组不交面子, 则剩下的$5$张牌可在一次换牌后做出对子, 该对子外的三张牌理论上可在两次换牌后和, 故至多为两向听. 严谨的证明应考量面子中含有暗杠之情形: 注意到三张不同的牌可能做出的面子数量至少为$5$, (极坏情形下)两组暗杠显然无从围堵. 从而此处的判定应如是完善:

   1. $5$张牌互不相同, 则第一次换牌做对子, 后两次换牌做面子.
   2. 有且仅有一个对子, 两次换牌做对子.
   3. 有且仅有两个对子时, 若两个对子都无法做刻子, 则先前三面子包含的牌至多覆盖七个连续位置, 拆去剩余$5$张牌中的一对及一单取做七个位置外的刻字即可(至多两向听); 若某对子可做刻子, 取$5$张牌中的孤立牌做上述对子的刻子. 

3. 若$S$有两组不交的面子, 则剩下$8$张牌在不产生顺子的情况下至多填占$6$个空位, 从而其中至少有两组对子. 若两组对子不可碰牌, 则不妨记构成面子的六张牌为$(344556)$与$(445566)$, 从而该六张牌连同两组对子构成
   $$
   (3444455556),(4444555566),(4444556666)
   $$
   三类情况, 每类均有三组面子, 矛盾! 因此至多有一组对子不可作刻子. 若仅有两组对子, 此时一次换牌可归结为上一类情形中$b$情况(向听数不超过$2+1=3$); 若有三组及以上的对子, 对组对子作刻子, 将剩下一组作雀脚即可(向听数不过$3$).

4. 据抽屉原理, $S$至少有一组面子(仅有一组面子之例$(11224455778999)$). 若面子为刻, 则余下的$11$张牌需填占$6$个位置, 从而有且仅有一处为单张, 此时原牌含有结构$aaabbc$($1,2,3$形): 此处需换一只牌做双同顺, 再剩下四对牌中拆一对做刻子, 故向听数不超过$3$. 同理, 当面子为顺时, 经相同的讨论可知向听数亦不超过$3$.

主定理证毕. 

结论: 清一色情形下, 只要摸到的牌同色, 随便摸摸应该就和了; 唯一的坑就是点和(或曰放铳, 点炮). 若运气好一些, 可以摸到九莲宝灯, 如
$$
S_0=(1112345678999)
$$
可以发现, $S_0$听任何一张同色牌. 
